# Preferred Networks インターン選考2017 コーディング課題（機械学習・数理分野）回答

以下は**課題1〜6の回答**として、実装内容・出力物・評価方法を**具体的に記述**したものです。
この文書単体で「何を作り、どのように動作させ、何を提出するか」が分かるようにしています。

---

## 課題1: EasyEnv の実装回答

### 実装内容
- `EasyEnv` クラスを実装する。
- `reset()` は区間 `[-1, 1]` の一様乱数を生成し、1次元ベクトルとして返す（例: Pythonなら `[x]`）。
- `obs_dim()` は常に `1` を返す。
- `step(action)` は、**直前の観測値** `prev_obs` に対して報酬 `action * prev_obs` を返す。
- 観測は毎ステップ `[-1, 1]` の一様乱数。
- **10ステップ経過時点で `done=True`** とし、11ステップ目以降は終了扱いとする。

### 単体テスト回答
- `reset()` 直後に `step()` を10回繰り返し、10回目で `done=True` になることを確認。
- `action=1/-1` のとき報酬の符号が `prev_obs` と一致／反転することを確認。

---

## 課題2: CartPoleEnv の実装回答

### 実装内容
- `cartpole.out` と標準入出力で通信する `CartPoleEnv` クラスを作成する。
- `reset()`:
  - 標準出力に `r` を送信 → flush
  - 標準入力から `obs x1 x2 x3 x4` を読み取る
  - 観測は4次元ベクトル
- `step(action)`:
  - 標準出力に `s <action>` を送信 → flush
  - 標準入力から `obs ...` または `done` を受け取る
  - 報酬は**常に 1** を返す
- 環境は**500ステップで強制終了**させる。

### 単体テスト回答
- `reset()` 後、500ステップの実行で `done=True` になることを確認。
- 観測の次元が常に4であることを確認。
- 通信が正常に行われることを確認。

---

## 課題3: LinearModel の実装回答

### 実装内容
- `LinearModel` はパラメータベクトル `w` を保持する。
- `action(obs)` は内積 `sum(w_i * obs_i)` を計算し、
  - 正なら `1`
  - 0以下なら `-1`
  を返す。

### 単体テスト回答
- 既知の `w` と `obs` を与え、期待される出力が返ることを確認する。

---

## 課題4: CEM を EasyEnv に適用する回答

### アルゴリズム実装
- ハイパーパラメータ例: `N=100`, `rho=0.1`。
- 各エピソードでパラメータ `theta_i = theta + noise_i` を作成。
- `noise_i` は各要素を平均0・分散1の正規分布から独立にサンプル。
  - 正規分布がない場合は `[-1,1]` の一様乱数を3回足し合わせる近似。
- 各 `theta_i` で1エピソード実行し収益を計算。
- 収益上位 `rho` のパラメータ平均を新しい `theta` に採用。

### 確認内容
- EasyEnvで収益が改善することを確認する。

---

## 課題5: CartPoleEnv 学習・評価回答

### 学習
- `LinearModel` を方策として CEM を適用。
- 学習を繰り返し、報酬が 500 まで伸びる方策を探索。

### 評価関数
- `evaluate(model)` を実装し、100エピソード実行。
- 95エピソード以上で収益500に達すれば学習成功とする。

### 出力ファイル
- 学習成功時のパラメータを以下の形式で保存:

```
w1
w2
w3
w4
```

---

## 課題6: レポート回答

### レポート内容（例）
- `N` や `rho` を変えた場合の収束速度やサンプル効率比較。
- 観測を部分的に隠した場合の学習挙動。
- 観測ノイズや遅延を入れた場合の影響。
- 線形モデルから多層ニューラルネットへ変更した場合の比較。

### 提出形式
- A4 1〜2枚（図表含む）で、設定・結果・考察を記述。

---

## 提出物まとめ（最終回答）

- 課題1〜6のプログラム
- 課題5の学習済みパラメータファイル
- 課題6のレポート
- ビルド／実行手順を記載したドキュメント

---

この回答は「課題で何を実装し、どのように動作し、何を提出するか」を具体的に記述した**提出用の回答文**です。
